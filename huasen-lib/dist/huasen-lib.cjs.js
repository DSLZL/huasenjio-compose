"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});require("core-js");const o=require("crypto"),b=require("constants");function A(e,t,r){r&&e();let n=null;function i(){clearTimeout(n),e(),n=setTimeout(i,t)}return n=setTimeout(i,t),{clear(){clearTimeout(n)}}}const S=Object.freeze(Object.defineProperty({__proto__:null,timeout2Interval:A},Symbol.toStringTag,{value:"Module"})),a=b.RSA_PKCS1_PADDING;function d(e,t,r,n,i){return o.publicEncrypt({key:t,padding:i||a},Buffer.from(e,r)).toString(n)}function y(e,t,r,n,i){return o.publicDecrypt({key:t,padding:i||a},Buffer.from(e,r)).toString(n)}function h(e,t,r,n,i){return o.privateEncrypt({key:t,padding:a},Buffer.from(e,r)).toString(n)}function g(e,t,r,n,i){return o.privateDecrypt({key:t,padding:a},Buffer.from(e,r)).toString(n)}function T(e,t,r,n){let i=0,c=[];for(;r[i*n];){let s=i*n,p=(i+1)*n;c.push(r.slice(s,p)),i++}let u=[];for(let s=0;s<c.length;s++){let p=e==="public"?d(c[s],t,"utf8","hex",a):h(c[s],t,"utf8","hex");u.push(p)}return u.join(":hs:")}function x(e,t,r){return r.split(":hs:").reduce((i,c)=>{let u=e==="public"?y(c,t,"hex","utf8",a):g(c,t,"hex","utf8");return i+u},"")}function f(){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let t="";const r=e.length;for(let n=0;n<16;n++)t+=e.charAt(Math.floor(Math.random()*r));return t}function E(){return[f(),f()]}function D(e,t){t=t;let r=[],n=o.createDecipheriv("aes-128-cbc",t[0],t[1]);return n.setAutoPadding(!0),r.push(n.update(e,"base64","utf8")),r.push(n.final("utf8")),r.join("")}function w(e,t){t=t||aesSecret;let r=[],n=o.createCipheriv("aes-128-cbc",t[0],t[1]);return n.setAutoPadding(!0),r.push(n.update(e,"utf8","base64")),r.push(n.final("base64")),r.join("")}let m={minLength:function(e,t,r){if(e&&e.length<t)return r},maxLength:function(e,t,r){if(e&&e.length>t)return r},isNonEmpty:function(e,t){if(e==="")return t},isInteger:function(e,t){if(e!==""&&!/^[0-9]+$/.test(e))return t},isPassword:function(e,t){if(e!==""&&!/(^\w+$)/.test(e))return t},isName:function(e,t){if(e!==""&&!/^[\u4E00-\u9FA5\uf900-\ufa2d0-9a-zA-Z]+$/.test(e))return t},isUrl:function(e,t){if(e!==""&&!/^((https?:\/\/)|(www\.))((([0-9]{1,3}\.){3}[0-9]{1,3})|localhost|(([a-zA-Z0-9\\-]+\.)+[a-zA-Z0-9]+)|(\[[0-9a-fA-F:]+\]))/.test(e))return t},isColor:function(e,t){if(e!==""&&!/^(#([0-9A-Fa-f]{3}){1,2}|rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\)|rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*(0(\.\d+)?|1(\.0+)?)\))$/.test(e))return t},isIp:function(e,t){if(e!==""&&!/^(localhost|([0-9]{1,3}\.){3}[0-9]{1,3})$/.test(e))return t},isEmail:function(e,t){if(e!==""&&!/^[A-Za-z0-9]+([-._][A-Za-z0-9]+)*@[A-Za-z0-9]+(-[A-Za-z0-9]+)*(\.[A-Za-z]{2,6}|[A-Za-z]{2,4}\.[A-Za-z]{2,3})$/.test(e))return t},isJSONObject:function(e,t){try{if(e==="")return;let r=JSON.parse(e);if(!(Object.prototype.toString.call(r)==="[object Object]"))return t}catch{return t}},isJSONArray:function(e,t){try{if(e==="")return;let r=JSON.parse(e);if(!(Object.prototype.toString.call(r)==="[object Array]"))return t}catch{return t}},isValidHeadTag:function(e,t){if(e==="")return;if(!/^<(title|meta|link|style|script|base|noscript)(\s+[\w\-:]+(=("[^"]*"|'[^']*'|[\w\-]+))?)*\s*>[\s\S]*?<\/\1>$/i.test(e.trim()))return t},isValidHtmlTag:function(e,t){if(e==="")return;if(!/^<([a-zA-Z][\w-]*)(\s+[\w\-:]+(=("[^"]*"|'[^']*'|[\w\-]+))?)*\s*>[\s\S]*?<\/\1>$/i.test(e.trim()))return t}};class l{constructor(){this.caches=[]}add(t,r){r.map(n=>{let i=n.strategy.split(/:|ï¼š/),c=i.shift();i.unshift(t),i.push(n.errMsg),this.caches.push(()=>m[c].apply(this,i))})}start(){for(let t of this.caches){let r=t();if(r)return r}}verify(t){this.clear();for(let r of t){let n=new l;n.add(r.value,r.rules);let i=n.start();if(i)return i}}getElementFormValidator(t){let r=t.map(i=>{let c=i.split("::");return{strategy:c[0],errMsg:c[1]}}),n=this;return function(i,c,u){let s=n.verify([{rules:r,value:c}]);s?u(new Error(s)):u()}}clear(){this.caches=[]}}exports.Validator=l;exports.decrypt=D;exports.encrypt=w;exports.getAESSecret=E;exports.privateDecrypt=g;exports.privateEncrypt=h;exports.publicDecrypt=y;exports.publicEncrypt=d;exports.rsaDecryptLong=x;exports.rsaEncryptLong=T;exports.strategies=m;exports.tool=S;
